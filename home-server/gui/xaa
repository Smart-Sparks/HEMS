import mariadb
import sys

#mariadb connection
try: 
    conn = mariadb.connect(user='root', password='', host='localhost', database='hems')
    conn.autocommit = False
    print("Successfully connected to the database.")
except mariadb.Error as e:
    print(f"Error connecting to MariaDB Platform: {e}")
    sys.exit(1)
# get cursor
cur = conn.cursor()

try:
    cur.execute("SELECT * FROM devices")
except mariadb.error as e:
    print(f"Error: {e}")
    sys.exit(2)

print([x[0] for x in cur.description])

for row in cur:
    print(row)
conn.close()
